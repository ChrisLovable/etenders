<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>eTenders Explorer</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/styles.css" />
<link rel="manifest" href="/manifest.json" />
<meta name="theme-color" content="#0ea5e9" />
</head>
<body>
<div id="app">
  <div class="sticky-header-tabs">
  <header class="app-header">
    <div class="left">
      <img src="/assets/logo.png" alt="Proper Consulting Engineers" class="logo" />
      <button id="updateBtn" class="btn primary lg"><i class="fa-solid fa-arrows-rotate" aria-hidden="true"></i> Update Latest</button>
      <div class="titles"></div>
    </div>
  </header>

  <nav class="tab-bar" role="tablist">
    <button type="button" class="tab-btn active" role="tab" aria-selected="true" data-tab="tenders"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i> Search tenders</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="add"><i class="fa-solid fa-plus" aria-hidden="true"></i> Add a Tender</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="employees"><i class="fa-solid fa-users" aria-hidden="true"></i> Employee groups</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="dashboard"><i class="fa-solid fa-chart-column" aria-hidden="true"></i> Dashboard</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="mytenders"><i class="fa-solid fa-folder-open" aria-hidden="true"></i> My tenders</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="watchalerts"><i class="fa-solid fa-bell" aria-hidden="true"></i> Watch alerts</button>
    <button type="button" class="tab-btn" role="tab" aria-selected="false" data-tab="notifications"><i class="fa-solid fa-envelope" aria-hidden="true"></i> Notifications</button>
  </nav>
  </div>

  <div id="tabTenders" class="tab-panel active" role="tabpanel">
  <section class="controls">
    <div class="search-all-container">
      <div class="panel-title">Search all tenders</div>
      <div class="search-input-row global-search-row">
        <span class="input-with-icon input-clearable">
          <i class="fa-solid fa-magnifying-glass icon-prefix" aria-hidden="true"></i>
          <input id="q" class="input" type="text" placeholder="Search keywords" />
          <button type="button" class="input-clear" id="searchClearBtn" aria-label="Clear search" title="Clear search">Ã—</button>
        </span>
        <span class="select-with-icon">
          <i class="fa-solid fa-building icon-prefix" aria-hidden="true"></i>
          <select id="organ" class="select" title="Organ of State"></select>
        </span>
        <span class="select-with-icon">
          <i class="fa-solid fa-tags icon-prefix" aria-hidden="true"></i>
          <select id="category" class="select" title="Category"></select>
        </span>
        <span class="select-with-icon">
          <i class="fa-solid fa-calendar-days icon-prefix" aria-hidden="true"></i>
          <select id="advRange" class="select" title="Advertised date range">
          <option value="any">Any time</option>
          <option value="7d">Last 7 days</option>
          <option value="30d">Last 30 days</option>
          <option value="90d">Last 90 days</option>
          <option value="this_month">This month</option>
          <option value="last_month">Last month</option>
          <option value="this_year">This year</option>
          <option value="last_year">Last year</option>
        </select>
        </span>
        <div class="radio-container inclusive-exclusive-container" title="Match all: every filter must match. Inclusive: any filter can match.">
          <label><input type="radio" name="mainMatchMode" value="all" /> Match all criteria ("AND")</label>
          <label><input type="radio" name="mainMatchMode" value="expansive" checked /> Inclusive ("OR")</label>
        </div>
        <button id="searchBtn" class="btn primary md"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i> Search</button>
        <button id="showAllBtn" class="btn primary md" title="Clear filters and show all tenders"><i class="fa-solid fa-list" aria-hidden="true"></i> Show all</button>
      </div>
    </div>
    <div class="top-split">
      <div class="top-panel collapsible collapsed" id="provMuniCollapsible">
        <button type="button" class="collapsible-header" aria-expanded="false" aria-controls="provMuniContent">
          <i class="fa-solid fa-chevron-down collapsible-icon" aria-hidden="true"></i>
          <span class="panel-title">View provincial / municipality tenders</span>
        </button>
        <div class="collapsible-content" id="provMuniContent">
        <div class="province-radios-wrap">
          <div id="provinceRadios" class="radio-container province-radios"></div>
          <select id="municipalScraperSel" class="select municipal-select" title="Select Municipality">
            <option value="">Select Municipality</option>
            <option value="matjhabeng">Matjhabeng</option>
            <option value="mangaung">Mangaung</option>
            <option value="nelsonmandelabay">Nelson Mandela Bay</option>
            <option value="buffalocity">Buffalo City</option>
            <option value="sarahbaartman">Sarah Baartman</option>
            <option value="kouga">Kouga</option>
            <option value="amathole">Amathole</option>
            <option value="masilonyana">Masilonyana</option>
            <option value="mohokare">Mohokare</option>
            <option value="moqhaka">Moqhaka</option>
            <option value="nketoana">Nketoana</option>
            <option value="phumelela">Phumelela</option>
          </select>
          <select id="province" class="select province-hidden-select"></select>
        </div>
        </div>
      </div>
    </div>
    <div class="custom-search-container collapsible collapsed" id="customSearchCollapsible">
      <button type="button" class="collapsible-header" aria-expanded="false" aria-controls="customSearchContent">
        <i class="fa-solid fa-chevron-down collapsible-icon" aria-hidden="true"></i>
        <span class="panel-title">Custom Search & Watch Alerts</span>
      </button>
      <div class="collapsible-content" id="customSearchContent">
      <div class="custom-search-buttons">
        <button id="clearCustomCriteriaBtnMain" class="btn primary md" title="Clear saved custom criteria"><i class="fa-solid fa-trash" aria-hidden="true"></i> Clear Custom Criteria</button>
        <button id="customCriteriaBtn" class="btn primary md" title="Set your saved search criteria"><i class="fa-solid fa-sliders" aria-hidden="true"></i> Custom criteria</button>
        <button id="searchMyCriteriaBtn" class="btn primary md" title="Search using your saved criteria"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i> Search my criteria</button>
        <div id="customCriteriaSummary" class="muted custom-criteria-summary">No custom criteria set</div>
        <span id="updateMsg" class="muted custom-search-msg"></span>
      </div>
      </div>
    </div>
  </section>
  </div>

  <div id="tabAdd" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="tab-add-placeholder"></div>
  </div>

  <div id="tabEmployees" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="employee-tab-content">
      <form id="employeeGroupForm" class="employee-form">
        <div class="form-row">
          <label class="form-label">Name <span class="required">*</span></label>
          <input type="text" id="empName" class="input" placeholder="Full name" required />
        </div>
        <div class="form-row">
          <label class="form-label">Email <span class="required">*</span></label>
          <input type="email" id="empEmail" class="input" placeholder="email@example.com" required />
        </div>
        <div class="form-row">
          <label class="form-label">Phone</label>
          <input type="tel" id="empPhone" class="input" placeholder="e.g. 083-123-4567" />
        </div>
        <div class="form-row">
          <label class="form-label">Employee number</label>
          <input type="text" id="empNumber" class="input" placeholder="e.g. EMP001" />
        </div>
        <button type="submit" class="btn primary"><i class="fa-solid fa-user-plus" aria-hidden="true"></i> Add member</button>
      </form>
      <div class="employee-list-wrap">
        <h3 class="employee-list-title">Members (<span id="employeeCount">0</span>)</h3>
        <ul id="employeeList" class="employee-list"></ul>
      </div>
    </div>
  </div>

  <div id="tabDashboard" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="dashboard" id="dashboardSection">
      <div class="dashboard-stats" id="dashboardStats"></div>
      <div class="dashboard-sections" id="dashboardSections"></div>
    </div>
  </div>

  <div id="tabMyTenders" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="my-tenders-content">
      <div class="show-inline" id="showInline">
        <label class="show-option"><input type="checkbox" id="showAll" checked /> Show all</label>
        <label class="show-option"><input type="checkbox" id="showInterested" /> Interested</label>
        <label class="show-option"><input type="checkbox" id="showReviewed" /> Reviewed</label>
        <label class="show-option"><input type="checkbox" id="showTendered" /> Tendered</label>
        <label class="show-option"><input type="checkbox" id="showNotInterested" /> Not interested</label>
      </div>
    </div>
  </div>

  <div id="tabWatchAlerts" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="watch-alerts-content">
      <div class="watch-alerts-controls">
        <select id="watchAlertsRange" class="select" title="How far back to look">
          <option value="7d">Last 7 days</option>
          <option value="30d">Last 30 days</option>
          <option value="90d">Last 90 days</option>
        </select>
        <button type="button" id="refreshWatchAlertsBtn" class="btn primary md"><i class="fa-solid fa-rotate" aria-hidden="true"></i> Refresh</button>
      </div>
      <div id="watchAlertsEmpty" class="watch-alerts-empty muted" style="display:none">
        <p>No custom criteria set. Go to the <strong>Search tenders</strong> tab, expand <strong>Custom Search & Watch Alerts</strong>, and click <strong>Custom criteria</strong> to save your watch rules.</p>
      </div>
    </div>
  </div>

  <div id="tabNotifications" class="tab-panel" role="tabpanel" aria-hidden="true">
    <div class="notifications-content">
      <div class="notifications-body">
        <div class="notification-card">
          <h3><i class="fa-solid fa-users" aria-hidden="true"></i> Recipients</h3>
          <p class="muted">Add team members in the <strong>Employee groups</strong> tab to receive notifications by email or phone when new tenders match your criteria.</p>
        </div>
        <div class="notification-card">
          <h3><i class="fa-solid fa-eye" aria-hidden="true"></i> Watch alerts</h3>
          <p class="muted">Set up custom criteria in the <strong>Search tenders</strong> tab, then use the <strong>Watch alerts</strong> tab to see new tenders matching your rules.</p>
        </div>
      </div>
    </div>
  </div>

  <section class="results" id="resultsSection">
    <div id="stats" class="muted"></div>
    <div id="gridScroll" class="grid-scroll">
      <div id="gridContainer" class="grid-container"></div>
    </div>
  </section>

  <div id="customCriteriaModal" class="modal" aria-hidden="true">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2>Custom criteria</h2>
        <button type="button" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <form id="customCriteriaForm" class="modal-body">
        <div class="criteria-section criteria-section-first">
          <label class="criteria-label">Match mode</label>
          <div class="radio-container inclusive-exclusive-container">
            <label><input type="radio" name="matchMode" value="all" /> Match all criteria ("AND")</label>
            <label><input type="radio" name="matchMode" value="expansive" checked /> Inclusive ("OR")</label>
          </div>
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Custom search words (comma or space separated)</label>
          <input type="text" id="customWords" class="input" placeholder="e.g. civil, engineering, roads, water" />
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Categories</label>
          <div id="categoryCheckboxes" class="checkbox-group"></div>
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Services</label>
          <div id="servicesCheckboxes" class="checkbox-group"></div>
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Provinces</label>
          <div id="provinceCheckboxes" class="checkbox-group"></div>
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Organ of State</label>
          <div id="organCheckboxes" class="checkbox-group"></div>
        </div>
        <div class="criteria-section">
          <label class="criteria-label">Advertised date range</label>
          <select id="criteriaAdvRange" class="select">
            <option value="any">Any time</option>
            <option value="7d">Last 7 days</option>
            <option value="30d">Last 30 days</option>
            <option value="90d">Last 90 days</option>
            <option value="this_month">This month</option>
            <option value="last_month">Last month</option>
            <option value="this_year">This year</option>
            <option value="last_year">Last year</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn primary md"><i class="fa-solid fa-check" aria-hidden="true"></i> Save criteria</button>
          <button type="button" id="clearCustomCriteriaBtn" class="btn primary md"><i class="fa-solid fa-trash" aria-hidden="true"></i> Clear Custom Criteria</button>
          <button type="button" class="btn primary modal-close-btn"><i class="fa-solid fa-xmark" aria-hidden="true"></i> Cancel</button>
        </div>
      </form>
    </div>
  </div>

</div>

<!-- Loading overlay -->
<div id="loadingOverlay" class="loading-overlay">
  <div class="loading-container">
    <div class="loading-spinner-large"></div>
    <div id="loadingMessage" class="loading-text">Loading...</div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script type="module" src="/main.js"></script>
</body>
</html>
